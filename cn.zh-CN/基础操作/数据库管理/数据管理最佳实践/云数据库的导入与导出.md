云数据库的导入与导出 
===============================

本文介绍如何对云数据库进行导入与导出操作。

数据导出 
-------------------------

您可以将数据库中的内容导出为JSON或者CSV格式的文件，导出结果中的每行数据都对应数据库中的一条记录。


|  导出格式  | 是否必须指定导出字段 |         默认导出内容          | 建议使用场景 |
|--------|------------|-------------------------|--------|
| JSON格式 | 不必须        | 默认导出全部内容，指定字段时仍会导出_id字段 | 备份数据   |
| CSV格式  | 必须         | 仅导出指定字段                 | 分析数据   |



控制台操作步骤：

1. 在[云数据库管理页面](https://mp.console.aliyun.com/cloudDev/db)，单击 **目标数据库** 。

   

2. 在 **数据** 页签单击 **导出** 。

   

3. 在导出页面，下拉选择 **导出格式** ，然后填入要 **导出的字段** ，最后单击 **确定** 。

   ![数据库导出](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1730376061/p186551.png)
   



**注意**

* 云数据库导出时会丢失部分类型信息，不能保证导出后再导入后的内容和原有的数据完全一致。

  

* 若您的集合数据量比较大，导出需要较长的时间，建议您耐心等待，导出完成后浏览器会自动下载导出后的文件。

  




数据导入 
-------------------------

您可以将JSON或者CSV格式的文件导入进数据库，导入文件中的每行数据都对应数据库中的一条记录。

JSON文件格式要求如下。

* 每行都是一个完整的JSON，并且类型是一个JSON对象，不能是JSON数组或者JSON的基本类型。

  

* JSON 数据每个键值对的键名首尾不能是英文句号（.），并且不能包含多个连续的英文句号（.）。

  

* 键名不能重复。

  




CSV文件格式要求首行作为导入后的键名，用英文逗号（,） 分隔，其余为键值记录，与首行键名一一对应。

导入支持两种 **冲突处理模式** 。

* Insert模式：会尝试插入文件中的数据，若导入过程中出现了主键冲突或者惟一索引冲突，则忽略该记录，后面的数据不受影响。

  

* Upsert模式：会判断该记录是否存在，若已存在则更新记录，若不存在则插入记录，若出现了惟一索引冲突则会直接中止导入操作。

  




控制台操作步骤：

1. 在[云数据库管理页面](https://mp.console.aliyun.com/cloudDev/db)，单击 **目标数据库** 。

   

2. 在 **数据** 页签单击 **导入** 。

   

3. 在导入页面，单击 **上传文件** ，选择本地文件完成上传后，选择冲突处理模式，最后单击 **确定** 。

   ![数据导入](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1730376061/p186575.png)
   **说明**
   * 若文件中没有_id字段，导入过程中会自动生成_id。

     
   
   * 导入文件的内容格式与导出文件的格式相同，要求必须是UTF-8编码格式。导入文件最大支持50M。

     
   
   * 导入操作不是原子操作，可能会出现部分数据导入成功，部分数据导入失败的情况。

     
   
   * 若您导入的数据量比较大，导入需要较长的时间，建议您耐心等待导入结果。

     
   

   
   




错误码说明 
--------------------------



|         错误码         |                  描述信息                  |
|---------------------|----------------------------------------|
| SERVER_BUSY         | 服务端繁忙，建议您稍后再试。                         |
| INVALID_FILE_FORMAT | 导入时，文件格式错误，建议您检查文件格式。                  |
| DUPLICATE_KEY_ERROR | 导入时，出现了惟一索引冲突，建议您检查原有数据和导入数据，检查惟一索引设置。 |
| INTERNAL_ERROR      | 服务端错误，建议您重试，如果仍然失败请提交工单。               |



